<!DOCTYPE html>
<html lang="id">
<head><meta name="google-site-verification" content="d4JupO0ICDqx9R5OCwCo2AJewusNucSbQBDNxiAHKQU" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mj-Shop ULTRA FINAL BOSS</title>
<meta name="description" content="Mj-Shop: Produk, Artikel & Testimoni Pelanggan. Order via WhatsApp.">
<meta name="theme-color" content="#3aa655">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<meta name="google-site-verification" content="3eEt-BDrNTx1-ZYFwGEB-5hvz73i71dSlG8w93NjZeg">
<style>
/* ===== RESET & GLOBAL ===== */
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial,sans-serif}
body{background:#f5f5f5;color:#333;padding-bottom:180px;overflow-x:hidden;scroll-padding-top:120px;}
a{cursor:pointer;text-decoration:none}

/* ===== HEADER & NAVBAR ===== */
header{
  position:fixed;top:0;left:0;right:0;width:100%;
  background:#fff;padding:12px 14px;
  box-shadow:0 5px 15px rgba(0,0,0,.2);z-index:10000;
  transition:.25s ease;
}
header h2{
  font-size:22px;color:#3aa655;font-weight:800;letter-spacing:1px;margin-bottom:8px;transition:.25s;
}
header nav{display:flex;justify-content:center;gap:8px;flex-wrap:wrap;}
nav a{
  padding:8px 14px;border-radius:20px;font-size:14px;font-weight:600;
  color:#555;background:#f2f2f2;position:relative;overflow:hidden;transition:.25s;
}
nav a:hover{background:#3aa655;color:#fff}
nav a.active{background:#3aa655;color:#fff}
nav a::after{
  content:"";position:absolute;left:50%;bottom:4px;width:0;height:2px;
  background:#3aa655;transform:translateX(-50%);transition:.3s;
}
nav a.active::after{width:60%;}

/* MODE SWITCH */
.nav-mode{display:flex;justify-content:center;gap:6px;margin-top:6px;}
.nav-mode button{padding:4px 10px;border:none;border-radius:12px;font-size:12px;cursor:pointer;background:#eaeaea;}
.nav-mode button:hover{opacity:.8}

/* HEADER SHRINK / HIDE */
header.shrink{padding:6px 12px;box-shadow:0 2px 8px rgba(0,0,0,.15);}
header.shrink h2{font-size:18px}
header.hide{transform:translateY(-100%)}

/* MODES */
header.clean{background:#fff}
header.clean nav a{background:#f2f2f2;color:#555}
header.clean nav a.active{background:#3aa655;color:#fff}

header.agresif{background:linear-gradient(135deg,#3aa655,#d1b280);}
header.agresif nav a{background:#fff;color:#333;font-weight:700;}
header.agresif nav a.active{background:#000;color:#fff}

header.minimal{background:#fff;box-shadow:none;border-bottom:1px solid #ddd;}
header.minimal nav a{background:none;color:#333;}
header.minimal nav a.active{border-bottom:2px solid #3aa655;border-radius:0}

header.dark{background:#111;}
header.dark h2{color:#3aa655}
header.dark nav a{background:#222;color:#eee}
header.dark nav a.active{background:#3aa655;color:#fff}

body.dark, body.auto-dark{background:#000;color:#ddd}

/* MOBILE SWIPE HINT */
@media(max-width:768px){
  header::after{content:"‚áÜ swipe";font-size:10px;opacity:.4;display:block;margin-top:2px;}
}

/* ===== SECTIONS ===== */
section{display:none;padding:120px 10px 60px;max-width:900px;margin:0 auto;min-height:calc(100vh - 120px);}
section.active{display:block}

/* ===== SLIDER & CARD ===== */
.slider{display:flex;overflow-x:auto;gap:10px;scroll-behavior:smooth;padding:10px 0}
.slider::-webkit-scrollbar{height:6px}
.slider::-webkit-scrollbar-thumb{background:rgba(58,166,85,.8);border-radius:4px}
.card{background:rgba(255,255,255,.85);color:#333;padding:10px;border-radius:12px;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,.12);transition:.4s;margin-bottom:10px;display:flex;flex-direction:column;}
.card:hover{transform:translateY(-3px) scale(1.02);box-shadow:0 8px 16px rgba(0,0,0,.18)}
.card img{width:100%;height:150px;object-fit:cover;border-radius:6px;transition:.3s;margin-bottom:6px}
.card img:hover{transform:scale(1.05)}
.btn{background:linear-gradient(135deg,#3aa655,#d1b280);color:#fff;padding:6px 10px;border-radius:6px;border:none;cursor:pointer;margin-top:6px;font-size:13px;transition:.4s}
.btn-danger{background:red}
.btn:hover{transform:scale(1.05) rotate(-1deg);opacity:.9}
input,textarea,select{width:100%;padding:6px;margin-top:6px;font-size:13px}
textarea{resize:none}
.cart-box{background:rgba(255,255,255,.85);color:#333;padding:10px;border-radius:8px;margin:10px 0;box-shadow:0 3px 8px rgba(0,0,0,.15)}
.bio-link-bottom{position:fixed;bottom:40px;left:50%;transform:translateX(-50%);display:flex;gap:10px;z-index:999}
.bio-link-bottom a{display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%;background:rgba(255,255,255,0.9);transition:.3s}
.bio-link-bottom a img{width:24px;height:24px}
.bio-link-bottom a:hover{transform:scale(1.2)}
section h3{color:#3aa655;margin-bottom:10px}
#homeProduk,#produkList{display:grid;grid-template-columns: repeat(auto-fill,minmax(45%,1fr));gap:10px}
#artikelList .card p{-webkit-line-clamp:3;display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}
#homeArtikel .card,#homeTestimoni .card{min-width:200px;max-width:200px;max-height:250px;overflow:hidden}
.detail-page{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:#fff;overflow:auto;padding:20px;z-index:10001;}
.detail-page.active{display:block;}
.detail-page .close-detail{position:absolute;top:10px;right:10px;font-size:22px;cursor:pointer;font-weight:bold;color:#333;}
.detail-page img{max-width:100%;border-radius:6px;margin-bottom:10px;}
.skeleton{background:linear-gradient(90deg,#eee,#f5f5f5,#eee);background-size:200% 100%;animation:shimmer 1.2s infinite;border-radius:8px;}
@keyframes shimmer{from{background-position:200%}to{background-position:-200%}}
.skeleton-card{height:160px;margin-bottom:10px}
@media(max-width:768px){.card img{height:120px}header h2{font-size:20px}#homeProduk,#produkList{grid-template-columns: repeat(2,1fr);}}
@media(min-width:1024px){.card img{height:150px}}
</style>
</head>
<body>

<header>
<h2>Mj-Shop</h2>
<nav role="navigation" aria-label="Main Navigation">
<a href="#" data-page="home">Home</a>
<a href="#" data-page="produk">Produk</a>
<a href="#" data-page="artikel">Artikel</a>
<a href="#" data-page="testimoni">Testimoni</a>
<a href="#" data-page="cart">Keranjang</a>
<a href="#" data-page="admin">Admin</a>
</nav>
<div class="nav-mode">
  <button onclick="setMode('clean')">Clean</button>
  <button onclick="setMode('agresif')">Jualan</button>
  <button onclick="setMode('minimal')">Minimal</button>
  <button onclick="setMode('dark')">Dark</button>
</div>
</header>

<section id="home" class="active">
<h3>Produk Terbaru</h3>
<div id="homeProduk"></div>
<h3>Artikel Terbaru</h3>
<div class="slider" id="homeArtikel"></div>
<h3>Testimoni Pelanggan</h3>
<div class="slider" id="homeTestimoni"></div>
</section>

<section id="produk">
<h3>Produk</h3>
<label>Filter Kategori & Harga</label>
<select id="filterKategori">
<option value="all">Semua</option>
<option value="fashion">Fashion</option>
<option value="rumah">Rumah</option>
<option value="gadget">Gadget</option>
<option value="lain">Lain-lain</option>
</select>
<select id="filterHarga">
<option value="all">Harga Semua</option>
<option value="murah">Murah ‚Üí Mahal</option>
<option value="mahal">Mahal ‚Üí Murah</option>
</select>
<div id="produkList"></div>
</section>

<section id="artikel"><h3>Artikel</h3><div id="artikelList"></div></section>
<section id="testimoni"><h3>Testimoni</h3><div id="testimoniList"></div></section>

<section id="cart">
<h3>Keranjang Belanja</h3>
<div class="cart-box" id="cartList">Belum ada produk di keranjang</div>
<p><b>Total: Rp <span id="totalHarga">0</span></b></p>
<button class="btn btn-danger" onclick="checkout()">Checkout via WhatsApp</button>
</section>

<section id="admin">
<h3>Admin Panel üîê</h3>
<div id="loginBox">
<input id="adminEmail" placeholder="Email admin">
<input id="adminPassword" type="password" placeholder="Password">
<button class="btn" onclick="loginAdmin()">Login</button>
</div>
<div id="adminBox" style="display:none">
<button class="btn btn-danger" style="margin-bottom:10px;" onclick="logoutAdmin()">Logout</button>
<h4>Produk (Tambah / Hapus)</h4>
<input id="pnama" placeholder="Nama Produk">
<input id="pharga" placeholder="Harga Produk">
<input id="pstok" placeholder="Stok Produk">
<select id="pkategori">
<option value="fashion">Fashion</option>
<option value="rumah">Rumah</option>
<option value="gadget">Gadget</option>
<option value="lain">Lain-lain</option>
</select>
<input id="pgambar" placeholder="Link gambar">
<button class="btn" onclick="tambahProduk()">Tambah Produk</button>

<h4>Artikel (Tambah)</h4>
<input id="anama" placeholder="Judul Artikel">
<textarea id="aisi" placeholder="Isi Artikel"></textarea>
<input id="agambar" placeholder="Link gambar artikel">
<button class="btn" onclick="tambahArtikel()">Tambah Artikel</button>

<h4>Testimoni (Tambah)</h4>
<input id="tnama" placeholder="Nama Pelanggan">
<textarea id="tisi" placeholder="Isi Testimoni"></textarea>
<input id="tgambar" placeholder="Link gambar testimoni">
<button class="btn" onclick="tambahTestimoni()">Tambah Testimoni</button>
</div>
</section>

<div class="bio-link-bottom">
<a href="https://wa.me/6285691451094" target="_blank"><img src="https://img.icons8.com/color/48/000000/whatsapp.png"/></a>
<a href="https://instagram.com/mjshop" target="_blank"><img src="https://img.icons8.com/color/48/000000/instagram-new.png"/></a>
<a href="https://t.me/mjshop" target="_blank"><img src="https://img.icons8.com/color/48/000000/telegram-app.png"/></a>
<a href="https://tiktolk.com/@mj_shop91" target="_blank"><img src="https://img.icons8.com/color/48/000000/tiktok--v1.png"/></a>
<a href="https://www.facebook.com/profile.php?id=61585424703436" target="_blank"><img src="https://img.icons8.com/color/48/000000/facebook-new.png"/></a>
</div>

<footer>¬© Mj-Shop ‚Ä¢ Order via WhatsApp</footer>

<div class="detail-page" id="detailPage">
<span class="close-detail">√ó</span>
<div id="detailContent"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import { getFirestore, collection, addDoc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig={apiKey:"AIzaSyD3OBIuIqu5C9zCO_CexO4wIVLjX1Hf3vU",authDomain:"mj-shop-2d1e0.firebaseapp.com",projectId:"mj-shop-2d1e0",storageBucket:"mj-shop-2d1e0.appspot.com",messagingSenderId:"592598529202",appId:"1:592598529202:web:98f1777ca3cda7e69a45ab"};
const app=initializeApp(firebaseConfig), auth=getAuth(app), db=getFirestore(app);

let isAdmin=false, cart=[], produkCache=[], artikelCache=[], testimoniCache=[];
const loginBox=document.getElementById("loginBox"), adminBox=document.getElementById("adminBox");
const detailPage=document.getElementById("detailPage"), detailContent=document.getElementById("detailContent");
const header=document.querySelector("header");
const navLinks=document.querySelectorAll("nav a");
const sections=document.querySelectorAll("section");

/* ================= NAVBAR & MODE SYSTEM ================= */
let lastScroll=0;
window.setMode=(mode)=>{
  document.body.className="";
  header.className="";
  header.classList.add(mode);
  if(mode==="dark") document.body.classList.add("dark");
  localStorage.setItem("navMode",mode);
};
const savedMode=localStorage.getItem("navMode");
if(savedMode){
  setMode(savedMode);
}else{
  const hour=new Date().getHours();
  const prefersDark=window.matchMedia("(prefers-color-scheme: dark)").matches;
  if(prefersDark || hour>=18 || hour<6){
    setMode("dark");
    document.body.classList.add("auto-dark");
  }else{
    setMode("clean");
  }
}
navLinks.forEach(a=>a.addEventListener("click",()=>{
  navLinks.forEach(x=>x.classList.remove("active"));
  a.classList.add("active");
  document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
  document.getElementById(a.dataset.page).classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
}));

window.addEventListener("scroll",()=>{
  const y=window.scrollY;
  header.classList.toggle("shrink",y>40);
  if(y>lastScroll && y>120){header.classList.add("hide");}else{header.classList.remove("hide");}
  lastScroll=y;
});
const observer=new IntersectionObserver(entries=>{
  entries.forEach(e=>{
    if(e.isIntersecting){
      navLinks.forEach(a=>{
        a.classList.toggle("active",a.dataset.page===e.target.id);
      });
    }
  });
},{rootMargin:"-45% 0px -45% 0px"});
sections.forEach(s=>observer.observe(s));

let touchStartX=0;
document.addEventListener("touchstart",e=>{touchStartX=e.changedTouches[0].screenX;});
document.addEventListener("touchend",e=>{
  const diff=e.changedTouches[0].screenX-touchStartX;
  if(Math.abs(diff)>80){
    const pages=[...navLinks].map(a=>a.dataset.page);
    const active=document.querySelector("nav a.active")?.dataset.page||"home";
    let idx=pages.indexOf(active);
    if(diff<0 && idx<pages.length-1) navLinks[idx+1].click();
    if(diff>0 && idx>0) navLinks[idx-1].click();
  }
});

/* ================= ADMIN ================= */
window.loginAdmin=()=>signInWithEmailAndPassword(auth,adminEmail.value,adminPassword.value).catch(e=>console.error(e.message));
window.logoutAdmin=()=>signOut(auth).catch(e=>console.error(e.message));
onAuthStateChanged(auth,user=>{
  if(user){loginBox.style.display="none";adminBox.style.display="block";isAdmin=true;}
  else{loginBox.style.display="block";adminBox.style.display="none";isAdmin=false;}
});

/* ================= CRUD ================= */
window.tambahProduk=async()=>{
  const nama=pnama.value.trim(), harga=parseInt(pharga.value), stok=parseInt(pstok.value)||0, kategori=pkategori.value, gambar=pgambar.value.trim();
  if(!nama||!harga||!gambar)return alert("Isi nama, harga, gambar");
  await addDoc(collection(db,"produk"),{nama,harga,stok,kategori,gambar,created:Date.now()});
  pnama.value='';pharga.value='';pstok.value='';pgambar.value='';
};

window.tambahArtikel=async()=>{
  const judul=anama.value.trim(), isi=aisi.value.trim(), gambar=agambar.value.trim();
  if(!judul||!isi)return alert("Isi judul & isi");
  await addDoc(collection(db,"artikel"),{judul,isi,gambar,created:Date.now()});
  anama.value='';aisi.value='';agambar.value='';
};

window.tambahTestimoni=async()=>{
  const nama=tnama.value.trim(), isi=tisi.value.trim(), gambar=tgambar.value.trim();
  if(!nama||!isi)return alert("Isi nama & isi");
  await addDoc(collection(db,"testimoni"),{nama,isi,gambar,created:Date.now()});
  tnama.value='';tisi.value='';tgambar.value='';
};

/* ================= SKELETON LOADING ================= */
const showSkeleton=(elId,count=4)=>{
  const el=document.getElementById(elId);
  el.innerHTML="";
  for(let i=0;i<count;i++){
    const s=document.createElement("div");
    s.className="card skeleton skeleton-card";
    el.appendChild(s);
  }
};
showSkeleton("homeProduk");
showSkeleton("produkList");
showSkeleton("homeArtikel");
showSkeleton("homeTestimoni");

/* ================= RENDER DATA ================= */
const renderData=(col,cache,elId)=>{
  const el=document.getElementById(elId); el.innerHTML="";
  cache.forEach(d=>{
    const card=document.createElement("div"); card.className="card";
    let textPreview=d.isi?d.isi.substring(0,100)+"...": "";
    card.innerHTML=`${d.gambar?`<img src="${d.gambar}">`:""}<div><b>${d.nama||d.judul}</b>${d.harga!==undefined?`<p>Rp ${d.harga.toLocaleString()}</p>`:""}<p>${textPreview}</p></div>`;
    el.appendChild(card);
    card.addEventListener("click",()=>showDetail(d));
  });
};

/* ================= SNAPSHOT REALTIME ================= */
onSnapshot(query(collection(db,"produk"),orderBy("created","desc")),(snap)=>{
  produkCache=snap.docs.map(d=>({id:d.id,...d.data()}));
  renderData("produk",produkCache,"homeProduk");
  renderData("produk",produkCache,"produkList");
});
onSnapshot(query(collection(db,"artikel"),orderBy("created","desc")),(snap)=>{
  artikelCache=snap.docs.map(d=>({id:d.id,...d.data()}));
  renderData("artikel",artikelCache,"homeArtikel");
  renderData("artikel",artikelCache,"artikelList");
});
onSnapshot(query(collection(db,"testimoni"),orderBy("created","desc")),(snap)=>{
  testimoniCache=snap.docs.map(d=>({id:d.id,...d.data()}));
  renderData("testimoni",testimoniCache,"homeTestimoni");
  renderData("testimoni",testimoniCache,"testimoniList");
});

/* ================= DETAIL PAGE ================= */
function showDetail(d){
  detailContent.innerHTML=`${d.gambar?`<img src="${d.gambar}">`:""}<b>${d.nama||d.judul}</b><p>${d.harga!==undefined?`Rp ${d.harga.toLocaleString()}`:""}</p><p>${d.stok!==undefined?`Stok: ${d.stok}`:""}</p>${d.isi?`<p>${d.isi}</p>`:""}${d.harga?`<button class="btn" onclick="addToCart('${d.id}')">Beli Produk</button>`:""}`;
  detailPage.classList.add("active");
  document.body.style.overflow="hidden";
}
document.querySelector(".close-detail").addEventListener("click", ()=>{
  detailPage.classList.remove("active");
  document.body.style.overflow="auto";
});

/* ================= KERANJANG ================= */
if(localStorage.getItem("cart")) cart=JSON.parse(localStorage.getItem("cart"));

const updateCart=()=>{
  const cl=document.getElementById("cartList");
  const totalEl=document.getElementById("totalHarga");
  if(cart.length===0){cl.innerHTML="Belum ada produk di keranjang"; totalEl.textContent="0"; return;}
  cl.innerHTML=""; let total=0;
  cart.forEach(p=>{
    total+=(p.harga*p.qty||0);
    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`<b>${p.nama}</b> (x${p.qty}) - Rp ${(p.harga*p.qty).toLocaleString()}`;
    cl.appendChild(div);
  });
  totalEl.textContent=total.toLocaleString();
};

window.addToCart=(id)=>{
  const prod=produkCache.find(p=>p.id===id);
  if(!prod) return alert("Produk tidak ditemukan");
  const exist=cart.find(c=>c.id===id);
  if(exist){exist.qty++;}else{cart.push({id:prod.id,nama:prod.nama,harga:prod.harga,qty:1});}
  localStorage.setItem("cart",JSON.stringify(cart)); updateCart(); alert("Produk ditambahkan ke keranjang"); detailPage.classList.remove("active");
};

window.checkout=()=>{
  if(cart.length===0)return alert("Keranjang kosong");
  const wa="6285691451094"; let msg="Halo, saya ingin order:\n";
  cart.forEach(p=>{msg+=`- ${p.nama} x${p.qty}\n`;});
  window.open(`https://wa.me/${wa}?text=${encodeURIComponent(msg)}`);
};

updateCart();
</script>
</body>
</html>
